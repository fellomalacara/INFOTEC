<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/assets/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://unpkg.com/ionicons@5.2.3/dist/ionicons.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="Estilos.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.8/xlsx.full.min.js"></script>

    <title>INFOTEC | DASHBOARD</title>
</head>

<body>
    <div class="d-flex">
        <div id="sidebar-container" class="bg-primary">
            <div class="logo mx-auto text-center">
                <h4 class="text-light font-weight-bold text-center">Tablero de metricas</h4>
            </div>
            <div class="menu">
                <a href="/" class="d-block text-light p-3 mt-5 ">
                    <i class=" icon ion-md-apps mx-auto"><ion-icon name="apps" class="mr-2 lead"></ion-icon></i>General</a>
                <a href="./dashboard.html" class="d-block text-light p-3">
                    <i class=" icon ion-md-apps"><ion-icon name="close-circle"class="mr-2 lead"></ion-icon></i>Incidentes</a>
                <a href="/WO.html" class="d-block text-light p-3">
                    <i class=" icon ion-md-apps"><ion-icon name="checkmark-circle" class="mr-2 lead"></ion-icon></i>Ordenes de trabajo</a>
                <a href="/PBI.html" class="d-block text-light p-3">
                    <i class=" icon ion-md-apps"><ion-icon name="construct" class="mr-2 lead"></ion-icon></i>Problemas</a>
                <a href="/CRQ.html" class="d-block text-light p-3">
                    <i class=" icon ion-md-apps"><ion-icon name="hammer" class="mr-2 lead"></ion-icon></i>Cambios</a>
                <a href="/Contactos.html" class="d-block text-light p-3">
                    <i class=" icon ion-md-apps"><ion-icon name="hammer" class="mr-2 lead"></ion-icon></i>Contactos</a>

            </div>
        </div>


        <div class="w-100">
            <nav class="navbar navbar-light bg-light">
                <a class="navbar-brand" href="#">
                    <img src="assets/LOGO.png" width="200" height="50" class="d-inline-block align-top" alt="" loading="lazy">
                </a>
            </nav>

            <div id="content">
                <section>
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-9 mt-4">
                                <h1 class="font-weight-bold mb-0">TABLERO DE CONTROL</h1>
                                <p class="lead text-muted">Actualizacion 14 de octubre de 2020</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section>
                    <div class="container">
                        <div class="card border-right-0 shadow p-3 mb-5 bg-white rounded white">

                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-4 stat my-2">
                                        <h5 class="text-muted text-center">CONTACTOS</h5>
                                        <h1 class="center mx-auto text-center" id="CONT">SIN ACTUALIZAR</h1>
                                        <h3 id="incidentes"></h3>
                                    </div>
                                    <div class="col-lg-4 stat my-2">
                                        <h5 class="text-muted text-center">TOTAL DE TICKETS</h5>
                                        <h1 class="center mx-auto text-center" id="TT">SIN ACTUALIZAR</h1>
                                    </div>
                                    <div class="col-lg-4  my-2">
                                        <h5 class="text-muted text-center">TICKETS/CONTACTOS</h5>
                                        <h1 class="center mx-auto text-center" id="DIV">SIN ACTUALIZAR</h1>

                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="card border-right-0 shadow p-3 mb-5 bg-white rounded white" id="principal">

                            <div class="card-body">
                                <div class="row">
                                    <div class="col-lg-3 stat my-2">
                                        <h5 class="text-muted text-center">INCIDENTES</h5>
                                        <h1 class="center mx-auto text-center" id="INC">SIN ACTUALIZAR</h1>

                                    </div>
                                    <div class="col-lg-3 stat my-2">
                                        <h5 class="text-muted text-center">ORDENES DE TRABAJO</h5>
                                        <h1 class="center mx-auto text-center" id="REQ">SIN ACTUALIZAR</h1>
                                    </div>
                                    <div class="col-lg-3 stat my-2">
                                        <h5 class="text-muted text-center">CAMBIOS</h5>
                                        <h1 class="center mx-auto text-center" id="CRQ">SIN ACTUALIZAR</h1>

                                    </div>
                                    <div class="col-lg-3  my-2">
                                        <h5 class="text-muted text-center">PROBLEMAS</h5>
                                        <h1 class="center mx-auto text-center" id="PBI">SIN ACTUALIZAR</h1>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <br>

                <script>
                    var url = "./cubo.xlsx";
                    var oReq = new XMLHttpRequest();
                    oReq.open("GET", url, true);
                    oReq.responseType = "arraybuffer";

                    oReq.onload = function(e) {

                        var info = readData();
                        let GPOTOP = [
                            info[0],


                        ]


                        let inc = GPOTOP.map(item => item.Incidentes);
                        let req = GPOTOP.map(item => item.Requerimientos);
                        let pbi = GPOTOP.map(item => item.Problemas);
                        let ccrq = GPOTOP.map(item => item.Cambios);
                        let tt = GPOTOP.map(item => item.TotalTickets);
                        let ctos = GPOTOP.map(item => item.Contactos);
                        let result = GPOTOP.map(item => item.div);


                        document.getElementById("INC").innerHTML = inc;
                        document.getElementById("REQ").innerHTML = req;
                        document.getElementById("PBI").innerHTML = pbi;
                        document.getElementById("CRQ").innerHTML = ccrq;
                        document.getElementById("TT").innerHTML = tt;
                        document.getElementById("CONT").innerHTML = ctos;
                        document.getElementById("DIV").innerHTML = result;



                        function readData() {

                            var arraybuffer = oReq.response;

                            var data = new Uint8Array(arraybuffer);
                            var arr = new Array();
                            for (var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);
                            var bstr = arr.join("");

                            var workbook = XLSX.read(bstr, {
                                type: "binary"
                            });

                            var first_sheet_name = workbook.SheetNames[0];

                            var worksheet = workbook.Sheets[first_sheet_name];
                            var info = XLSX.utils.sheet_to_json(worksheet, {
                                raw: true
                            });

                            return info;

                        }
                    }



                    oReq.send();
                </script>
                <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
                <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>


</body>

</html>